(globalThis.webpackChunklightning_tunnel=globalThis.webpackChunklightning_tunnel||[]).push([[871],{16897:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Page:()=>Rt});var n=s(55754),i=s(15780),r=s(92950),a=s(45055),l=s(32659),c=s(95418),o=s(19289);let d,u,h;!function(e){e[e.auto=1]="auto",e[e.manual=2]="manual"}(d||(d={})),function(e){e[e.one=1]="one",e[e.two=2]="two",e[e.three=3]="three"}(u||(u={})),function(e){e.activeKey="collapse-upload-csv"}(h||(h={}));const p="steps",x={step:u.one},m=(0,o.createAsyncThunk)("steps/onSelectStep",(async e=>({step:e}))),j=(0,o.createSlice)({name:p,initialState:x,reducers:{},extraReducers:e=>{e.addCase(m.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)}))}}).reducer,y="main",g={methodSelected:void 0,mintSelected:"",visible:!1,isTyping:!1},f=(0,o.createAsyncThunk)("main/onSelectMethod",(async e=>({methodSelected:e}))),w=(0,o.createAsyncThunk)("main/onSelectedMint",(async e=>({mintSelected:e}))),b=(0,o.createAsyncThunk)("main/setVisible",(async e=>({visible:e}))),C=(0,o.createAsyncThunk)("main/setIsTyping",(async e=>({isTyping:e}))),v=(0,o.createSlice)({name:y,initialState:g,reducers:{},extraReducers:e=>{e.addCase(f.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(w.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(b.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(C.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)}))}}).reducer,S="recipients",k=(0,o.createAsyncThunk)("recipients/addRecipients",(async e=>{let{recipients:t}=e;return{recipients:t}})),T=(0,o.createAsyncThunk)("recipients/addRecipient",(async(e,t)=>{let{recipient:s}=e,{getState:n}=t;const{recipients:{recipients:i}}=n(),r=[...i];return r.push(s),{recipients:r}})),A=(0,o.createAsyncThunk)("recipients/removeRecipients",(async()=>({recipients:[]}))),R=(0,o.createAsyncThunk)("recipients/removeRecipient",(async(e,t)=>{let{recipient:s}=e,{getState:n}=t;const{recipients:{recipients:i}}=n(),r=[...i],a=r.indexOf(s);return a>-1&&r.splice(a,1),{recipients:r}})),I=(0,o.createAsyncThunk)("recipients/setErrorDatas",(async e=>{let{errorData:t}=e;return{errorData:t}})),N=(0,o.createSlice)({name:S,initialState:{recipients:[],errorData:[]},reducers:{},extraReducers:e=>{e.addCase(k.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(T.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(A.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(I.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(R.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)}))}}).reducer,B=()=>{const{recipients:{recipients:e},setting:{decimal:t}}=(0,n.useSelector)((e=>e));return{amountError:(0,r.useMemo)((()=>{for(const[s,n]of e){if(!c.account.isAddress(s))return!0;if(!t&&Number(n)%1!==0)return!0}return!1}),[t,e])}},D=e=>{const[t,s]=(0,r.useState)(void 0),{getDecimals:n}=(0,i.useMint)(),a=(0,r.useCallback)((async()=>{try{const t=await n(e);return s(t)}catch(t){return s(void 0)}}),[e,n]);return(0,r.useEffect)((()=>{a()}),[a]),t},E=(e,t,s)=>c.account.isAddress(e)&&void 0!==t&&void 0!==s?{mintAddress:e,amount:t,decimals:s,balance:Number(c.utils.undecimalize(t,s))}:{amount:BigInt(0),decimals:0,balance:0},z=e=>{const{wallet:{address:t,lamports:s}}=(0,i.useWallet)(),{accounts:n}=(0,i.useAccount)(),{amount:r,mint:a}=n[e]||{},l=D(a)||0;return c.account.isAddress(t)&&c.account.isAddress(e)?e===t?E(c.DEFAULT_EMPTY_ADDRESS,s,9):E(a,r,l):E()},O=e=>{const[t,s]=(0,r.useState)(""),{wallet:{address:n}}=(0,i.useWallet)(),a=z(t);return(0,r.useEffect)((()=>{(async()=>{if(!c.account.isAddress(n)||!c.account.isAddress(e))return s("");const{sentre:{splt:t}}=window;try{const i=await t.deriveAssociatedAddress(n,e);s(i)}catch(i){return s("")}})()})),a},M=()=>{const{main:{mintSelected:e},recipients:{recipients:t,errorData:s},setting:{decimal:i}}=(0,n.useSelector)((e=>e)),a=D(e)||0,l=(0,r.useCallback)((e=>{if(!e.length||!a)return BigInt(0);let t=BigInt(0);for(const s of e){const e=s[1];i?t+=c.utils.decimalize(e,a):Number(e)%1===0&&(t+=BigInt(e))}return t}),[i,a]),o=s.filter((e=>!e.includes("")&&c.account.isAddress(e[0]))),d=l(t)+l(o),u=o.length,h=(0,r.useMemo)((()=>t.length),[t]);return{total:c.utils.undecimalize(d,a).toString(),quantity:h+u}},P=e=>{const{balance:t}=O(e),{total:s}=M();return(0,r.useMemo)((()=>t?t-Number(s):0),[t,s])};var F=s(45263);const L=()=>{const e=(0,n.useDispatch)(),{recipients:{recipients:t,errorData:s},main:{isTyping:i,mintSelected:a}}=(0,n.useSelector)((e=>e)),{amountError:o}=B(),d=P(a),h=(0,r.useMemo)((()=>{if(!s)return!1;for(const[e,t]of s)if(!c.account.isAddress(e)||!t)return!0;return!1}),[s]),p=!t.length||o||h||i||d<0,x=(0,r.useCallback)((async()=>{await e(f()),e(A()),e(m(u.one))}),[e]);return(0,F.jsxs)(l.Row,{gutter:[16,16],children:[(0,F.jsx)(l.Col,{span:12,children:(0,F.jsx)(l.Button,{type:"ghost",size:"large",onClick:x,block:!0,children:"Back"})}),(0,F.jsx)(l.Col,{span:12,children:(0,F.jsx)(l.Button,{size:"large",onClick:()=>e(m(u.three)),type:"primary",disabled:p,block:!0,children:"Continue"})})]})};var q=s(24656),Q=s.n(q),W=s(18268),_=s.n(W);const U={"logo-telegram":s.p+"static/media/icon-telegram.2450489f40d03000fe65fc1c6f238d85.svg"},$=(0,r.forwardRef)(((e,t)=>{let{name:s,className:n,...i}=e;const r=n?"anticon "+n:"anticon";return(0,F.jsx)("span",{className:r,...i,children:U[s]?(0,F.jsx)("ion-icon",{ref:t,src:U[s]}):(0,F.jsx)("ion-icon",{ref:t,name:s})})})),K=e=>{let{visible:t,setVisible:s,title:n,description:i,onConfirm:r,onCancel:a,btnText:c}=e;return(0,F.jsx)(l.Modal,{visible:t,closeIcon:(0,F.jsx)($,{name:"close-outline"}),onCancel:()=>s(!1),footer:null,className:"card-lightning",style:{paddingBottom:0},children:(0,F.jsxs)(l.Row,{gutter:[32,32],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{size:15,align:"baseline",children:[(0,F.jsx)($,{name:"alert-circle-outline",style:{color:"#FA8C16",fontSize:18}}),(0,F.jsxs)(l.Space,{size:4,direction:"vertical",children:[(0,F.jsx)(l.Typography.Text,{children:n}),(0,F.jsx)(l.Typography.Text,{type:"secondary",children:i})]})]})}),(0,F.jsx)(l.Col,{span:24,style:{textAlign:"right"},children:(0,F.jsxs)(l.Space,{children:[(0,F.jsx)(l.Button,{onClick:a,type:"ghost",children:"cancel"}),(0,F.jsx)(l.Button,{onClick:r,type:"primary",children:c})]})})]})})};let Y;const H=(0,r.forwardRef)(((e,t)=>{var s;let{max:n,onValue:i=(()=>{}),onChange:a=(()=>{}),...c}=e;const[o,d]=(0,r.useState)(""),[u,h]=(0,r.useState)(null),p=(0,r.useRef)(t),x=(0,r.useCallback)((e=>{const t=e=>{Y&&(clearTimeout(Y),Y=void 0),d(e),Y=setTimeout((()=>d("")),500)};return/^\d*(\.\d*)?$/.test(e)?n&&parseFloat(e)>parseFloat(n.toString())?t("Not enough balance"):i(e):t("Invalid character")}),[n,i]);return null!==u&&(null===p||void 0===p||null===(s=p.current)||void 0===s||s.setSelectionRange(u,u)),(0,F.jsx)(l.Tooltip,{title:(0,F.jsxs)(l.Space,{children:[(0,F.jsx)($,{name:"warning"}),o]}),visible:!!o,children:(0,F.jsx)(l.Input,{...c,onChange:e=>{a(e),h(e.target.selectionStart),x(e.target.value||"")},ref:p})})})),V="file",Z=(0,o.createAsyncThunk)("file/setFileName",(async e=>({fileName:e}))),J=(0,o.createAsyncThunk)("file/onSelectedFile",(async(e,t)=>{let{checked:s,index:n}=e,{getState:i}=t;const{file:{selectedFile:r},recipients:{recipients:a,errorData:l}}=i();if(void 0===n){const e=[...a],t=[...l||[]];if(!s)return{selectedFile:[]};const n=[];for(const s in e)n.push(Number(s));for(const s in t)n.push(e.length+Number(s));return{selectedFile:n}}const c=[...r];if(s)c.push(n);else{const e=c.indexOf(n);c.splice(e,1)}return{selectedFile:c}})),G=(0,o.createAsyncThunk)("file/removeSelectedFile",(async()=>({selectedFile:[]}))),X=(0,o.createSlice)({name:V,initialState:{fileName:"",selectedFile:[]},reducers:{},extraReducers:e=>{e.addCase(Z.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(J.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(G.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)}))}}).reducer,ee={walletAddress:"",amount:""},te=e=>{let{walletAddress:t,addNewRecipient:s,remove:n}=e;return(0,F.jsx)(r.Fragment,{children:t?(0,F.jsx)(l.Button,{type:"text",size:"small",style:{padding:0},onClick:n,icon:(0,F.jsx)($,{style:{fonSize:20},name:"trash-outline"})}):(0,F.jsx)(l.Button,{type:"text",size:"small",style:{padding:0,color:"#42E6EB"},onClick:s,children:"OK"})})},se=e=>{let{walletAddress:t,amount:s,index:i,isSelect:a=!1}=e;const[o,d]=(0,r.useState)(ee),[u,h]=(0,r.useState)(""),[p,x]=(0,r.useState)(""),[m,j]=(0,r.useState)(!1),{main:{mintSelected:y},recipients:{recipients:g},setting:{decimal:f},file:{selectedFile:w}}=(0,n.useSelector)((e=>e)),b=(0,n.useDispatch)(),v=D(y)||0,S=(0,r.useCallback)((async()=>c.account.isAddress(t)&&s?d({walletAddress:t,amount:s}):d(ee)),[t,s]),A=(0,r.useCallback)((()=>{if(!s&&!t)return o.walletAddress||o.amount?b(C(!0)):b(C(!1))}),[s,b,o.amount,o.walletAddress,t]),I=(0,r.useCallback)((()=>{if(s)return f?h(""):Number(s)%1!==0?h("Should be natural numbers"):void 0}),[s,f]),N=!!t;return(0,r.useEffect)((()=>{S()}),[S]),(0,r.useEffect)((()=>{I()}),[I]),(0,r.useEffect)((()=>{A()}),[A]),(0,F.jsxs)(l.Row,{gutter:[8,8],align:"middle",justify:"space-between",children:[a&&(0,F.jsx)(l.Col,{children:(0,F.jsx)(l.Checkbox,{checked:null===w||void 0===w?void 0:w.includes(i),onChange:e=>((e,t)=>b(J({checked:e,index:t})))(e.target.checked,i)})}),(0,F.jsx)(l.Col,{span:16,children:(0,F.jsx)(l.Input,{disabled:N,value:o.walletAddress,name:"walletAddress",placeholder:"Wallet address",onChange:e=>{d({...o,[e.target.name]:e.target.value})},className:"recipient-input",autoComplete:"off"})}),(0,F.jsx)(l.Col,{span:6,children:(0,F.jsx)(H,{disabled:N,value:s||o.amount,name:"amount",placeholder:"Amount",onValue:e=>d({...o,amount:e}),className:u?"recipient-input-error":"recipient-input",autoComplete:"off"})}),!a&&(0,F.jsx)(l.Col,{children:(0,F.jsx)(te,{addNewRecipient:async()=>{const{walletAddress:e,amount:t}=o;if(!c.account.isAddress(e))return x("Wrong wallet address");if(!t)return h("Amount cannot be empty");for(const[n]of g)if(e===n)return j(!0);const s=[e,t];return x(""),h(""),await b(T({recipient:s})),d(ee)},walletAddress:t,remove:()=>{if(void 0===i)return;const e=[...g];return e.splice(i,1),b(k({recipients:e}))}})}),(p||u)&&(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{children:[(0,F.jsx)($,{style:{color:"#f2323f"},name:"warning-outline"}),(0,F.jsx)(l.Typography.Text,{type:"danger",children:p||u})]})}),(0,F.jsx)(K,{title:"Do you want to merge wallet addresses?",description:"There are some wallet addresses that are the same.",btnText:"merge",onConfirm:async()=>{const{walletAddress:e,amount:t}=o,s=g.find((t=>{let[s]=t;return s===e}));if(!s||!v)return;const n=c.utils.decimalize(s[1],v)+c.utils.decimalize(t,v),i=[e,c.utils.undecimalize(n,v)];return await b(R({recipient:s})),await b(T({recipient:i})),await j(!1),(u||p)&&(h(""),x("")),d(ee)},visible:m,setVisible:j,onCancel:()=>j(!1)})]})},ne=[void 0],ie=e=>{let{mintAddress:t,size:s=24,icon:n=(0,F.jsx)($,{name:"diamond-outline"}),reversed:a=!1,...o}=e;const[d,u]=(0,r.useState)(ne),{tokenProvider:h}=(0,i.useMint)(),{pools:p}=(0,i.usePool)(),x=(0,r.useCallback)((async e=>{const t=await h.findByAddress(e);if(null!==t&&void 0!==t&&t.logoURI)return t.logoURI}),[h]),m=(0,r.useCallback)((async()=>{if(!c.account.isAddress(t))return u(ne);const e=Object.values(p||{}).find((e=>{let{mint_lpt:s}=e;return s===t}));if(e){const{mint_a:t,mint_b:s}=e,n=await Promise.all([t,s].map(x));return a&&n.reverse(),u(n)}const s=await x(t);return u([s])}),[t,a,x,p]);return(0,r.useEffect)((()=>{m()}),[m]),1===d.length?(0,F.jsx)(l.Avatar,{src:d[0],size:s,style:{backgroundColor:"#2D3355",border:"none"},...o,children:n}):(0,F.jsx)(l.Avatar.Group,{style:{display:"block",whiteSpace:"nowrap"},...o,children:d.map(((e,t)=>(0,F.jsx)(l.Avatar,{src:e,size:s,style:{backgroundColor:"#2D3355",border:"none"},children:n},t)))})},re="TOKN",ae=e=>{let{mintAddress:t,separator:s=" \u2022 ",reversed:n=!1}=e;const[a,l]=(0,r.useState)(re),{tokenProvider:o}=(0,i.useMint)(),{pools:d}=(0,i.usePool)(),u=(0,r.useCallback)((async e=>{const t=await o.findByAddress(e);return null!==t&&void 0!==t&&t.symbol?t.symbol:e.substring(0,4)}),[o]),h=(0,r.useCallback)((async()=>{if(!c.account.isAddress(t))return l(re);const e=Object.values(d||{}).find((e=>{let{mint_lpt:s}=e;return s===t}));if(e){const{mint_a:t,mint_b:i}=e,r=await Promise.all([t,i].map(u));return n&&r.reverse(),l(r.join(s))}const i=await u(t);return l(i)}),[t,n,u,d,s]);return(0,r.useEffect)((()=>{h()}),[h]),(0,F.jsx)("span",{children:a})};s(44891);var le=s(34559);const ce=e=>{let{label:t,value:s}=e;return(0,F.jsxs)(l.Row,{children:[(0,F.jsx)(l.Col,{flex:"auto",children:(0,F.jsx)(l.Typography.Text,{type:"secondary",children:t})}),(0,F.jsx)(l.Col,{children:s})]})},oe=()=>{const{main:{mintSelected:e}}=(0,n.useSelector)((e=>e)),{total:t,quantity:s}=M(),{balance:i}=O(e),r=P(e);return(0,F.jsxs)(l.Row,{gutter:[8,8],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(ce,{label:"Quantity",value:(0,F.jsx)(l.Typography.Text,{children:s})})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(ce,{label:"Total",value:(0,F.jsxs)(l.Space,{size:4,children:[(0,F.jsx)(l.Typography.Title,{level:5,children:t}),(0,F.jsx)(l.Typography.Title,{level:5,children:(0,F.jsx)(ae,{mintAddress:e})})]})})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(ce,{label:"Your balance",value:(0,F.jsxs)(l.Space,{size:4,children:[(0,F.jsx)(l.Typography.Text,{children:(0,le.uR)(i).format("0,0.00[0000]")}),(0,F.jsx)(l.Typography.Text,{children:(0,F.jsx)(ae,{mintAddress:e})})]})})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(ce,{label:"Remaining",value:(0,F.jsxs)(l.Space,{size:4,children:[(0,F.jsx)(l.Typography.Text,{children:(0,le.uR)(r).format("0,0.00[0000]")}),(0,F.jsx)(l.Typography.Text,{children:(0,F.jsx)(ae,{mintAddress:e})})]})})})]})},de=()=>(0,F.jsx)(l.Card,{bordered:!1,style:{borderRadius:8,boxShadow:"unset"},bodyStyle:{padding:"12px 16px"},className:"card-total",children:(0,F.jsx)(oe,{})}),ue=e=>{let{selected:t=!1,onChecked:s=(()=>{})}=e;const{recipients:{errorData:i}}=(0,n.useSelector)((e=>e));return(0,F.jsxs)(l.Row,{gutter:[16,8],align:"middle",wrap:!1,justify:"space-between",children:[(0,F.jsx)(l.Col,{span:3,children:(0,F.jsxs)(l.Space,{children:[t&&(0,F.jsx)(l.Checkbox,{className:"lightning-checkbox",onChange:e=>s(e.target.checked)}),(0,F.jsx)(l.Typography.Text,{type:"secondary",children:"No."})]})}),(0,F.jsx)(l.Col,{span:12,children:(0,F.jsx)(l.Typography.Text,{type:"secondary",children:"Wallet address"})}),(0,F.jsx)(l.Col,{span:6,children:(0,F.jsx)(l.Typography.Text,{type:"secondary",children:"Amount"})}),!!i.length&&(0,F.jsx)(l.Col,{span:3})]})},he=e=>{let{editable:t=!1,wrongAddress:s=!1}=e;return s?(0,F.jsx)(l.Tooltip,{title:"Wrong wallet address!",placement:"topLeft",arrowPointAtCenter:!0,children:(0,F.jsx)($,{name:"close-circle-outline",style:{color:"#d72311"}})}):t?(0,F.jsx)(l.Tooltip,{title:"Invalid  amount!",placement:"topLeft",arrowPointAtCenter:!0,children:(0,F.jsx)($,{name:"warning-outline",style:{color:"#d72311"}})}):(0,F.jsx)($,{name:"checkmark-outline",style:{color:"#03A326"}})},pe=e=>{let{wrongAddress:t=!1,isEdited:s=!1,onEdited:n=(()=>{}),onUpdate:i=(()=>{}),onDelete:r=(()=>{})}=e;return t?(0,F.jsx)(l.Button,{type:"text",icon:(0,F.jsx)($,{name:"trash-outline"}),onClick:r}):s?(0,F.jsx)(l.Button,{type:"text",icon:(0,F.jsx)($,{name:"cloud-upload-outline"}),onClick:i}):(0,F.jsx)(l.Button,{type:"text",icon:(0,F.jsx)($,{name:"create-outline"}),onClick:()=>n(!0)})},xe=(0,r.forwardRef)(((e,t)=>{let{accountAddress:s="",amount:i=0,selected:a=!1,onChecked:o=(()=>{}),index:d}=e;const u=(0,n.useDispatch)(),[h,p]=(0,r.useState)(!1),[x,m]=(0,r.useState)(""),{recipients:{errorData:j,recipients:y},file:{selectedFile:g},setting:{decimal:f}}=(0,n.useSelector)((e=>e)),w=(0,r.useRef)(t),b=!i,C=!c.account.isAddress(s),v=h?x:i,S=d-y.length,k=(0,r.useCallback)((()=>{if(!j.length||d-j.length<0)return;const e=[...j],[[t]]=e.splice(S,1);e.unshift([t,x]),u(I({errorData:e}))}),[u,j,S,d,x]),T=(0,r.useCallback)((async()=>{if(!j.length)return;const e=[...j];e.splice(S,1),u(I({errorData:e}))}),[u,j,S]),A=(0,r.useMemo)((()=>!!v&&(!f&&Number(i)%1!==0)),[i,v,f]);return(0,F.jsxs)(l.Row,{gutter:[16,8],align:"middle",justify:"space-between",wrap:!1,children:[(0,F.jsx)(l.Col,{span:3,children:(0,F.jsxs)(l.Space,{children:[a&&(0,F.jsx)(l.Checkbox,{checked:null===g||void 0===g?void 0:g.includes(d),onChange:e=>o(e.target.checked,d),className:"lightning-checkbox"}),(0,F.jsxs)(l.Typography.Text,{type:"secondary",children:["#",d+1]})]})}),(0,F.jsx)(l.Col,{span:12,children:(0,F.jsx)(l.Tooltip,{title:s,children:(0,F.jsx)(l.Typography.Text,{style:{color:C?"#F9575E":""},children:(0,le.Xn)(s)})})}),(0,F.jsx)(l.Col,{span:6,children:(0,F.jsx)(H,{value:v,bordered:h,onValue:m,disabled:!h,style:{padding:0},className:A?"recipient-input-error":"recipient-input-auto",ref:w})}),!!j.length&&(0,F.jsx)(l.Col,{span:3,children:b&&(0,F.jsxs)(l.Space,{align:"center",children:[(0,F.jsx)(he,{editable:b,wrongAddress:C}),(0,F.jsx)(pe,{isEdited:h,wrongAddress:C,onEdited:e=>{p(e),w.current&&w.current.focus()},onUpdate:k,onDelete:T})]})})]})})),me=e=>{let{activeKey:t="",selected:s=!1,onSelect:n,onCollapsed:i}=e;return s?(0,F.jsx)(l.Button,{type:"text",size:"small",onClick:()=>n(!1),children:"Cancel"}):t?(0,F.jsx)(l.Button,{type:"text",size:"small",onClick:()=>i(""),children:"Close"}):(0,F.jsxs)(l.Space,{size:24,children:[(0,F.jsx)(l.Button,{type:"text",size:"small",onClick:()=>n(!0),children:"SELECT"}),(0,F.jsx)(l.Button,{type:"text",size:"small",onClick:()=>i(h.activeKey),style:{color:"#42E6EB"},children:"ADD MORE"})]})},je=e=>{let{remove:t=(()=>{})}=e;const[s,i]=(0,r.useState)(!1),[a,c]=(0,r.useState)(),[o,d]=(0,r.useState)(!1),[u,p]=(0,r.useState)(!1),x=(0,n.useDispatch)(),{file:{fileName:m,selectedFile:j},recipients:{recipients:y,errorData:g}}=(0,n.useSelector)((e=>e)),{amountError:f}=B(),w=(e,t)=>x(J({checked:e,index:t}));return(0,F.jsxs)(l.Row,{gutter:[16,16],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Card,{className:"file-uploaded",bodyStyle:{padding:"8px 16px"},children:(0,F.jsxs)(l.Row,{gutter:8,children:[(0,F.jsx)(l.Col,{flex:"auto",children:(0,F.jsxs)(l.Space,{children:[(0,F.jsx)($,{name:"document-attach-outline"}),(0,F.jsx)(l.Typography.Text,{style:{color:"inherit"},children:m})]})}),(0,F.jsx)(l.Col,{children:(0,F.jsx)(l.Button,{type:"text",size:"small",style:{color:"inherit"},icon:(0,F.jsx)($,{name:"close-outline"}),onClick:()=>p(!0)})})]})})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Row,{gutter:[12,12],children:[(0,F.jsx)(l.Col,{flex:"auto",children:s&&(0,F.jsx)(l.Space,{children:(0,F.jsx)(l.Button,{type:"text",size:"small",icon:(0,F.jsx)($,{name:"trash-outline"}),onClick:()=>{if(null===j||void 0===j||!j.length)return;d(!0);const e=[...y],t=[...g||[]],s=e.filter(((e,t)=>!j.includes(t))),n=t.filter(((e,t)=>!j.includes(y.length+t)));x(I({errorData:n})),x(k({recipients:s})),x(G()),d(!1)},disabled:!(null!==j&&void 0!==j&&j.length),children:"Delete"})})}),(0,F.jsx)(l.Col,{children:(0,F.jsx)(me,{activeKey:a,selected:s,onSelect:i,onCollapsed:c})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Collapse,{activeKey:a,bordered:!1,className:"auto-add-new",children:(0,F.jsx)(l.Collapse.Panel,{header:void 0,children:(0,F.jsx)(se,{})},h.activeKey)})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Spin,{spinning:o,children:(0,F.jsx)(l.Card,{bordered:!1,className:"card-content",children:(0,F.jsxs)(l.Row,{gutter:[8,13],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(ue,{selected:s,onChecked:e=>x(J({checked:e}))})}),g.map(((e,t)=>{let[n,i]=e;return(0,F.jsx)(l.Col,{span:24,className:t+1===g.length?"last-item-error-data":"",children:(0,F.jsx)(xe,{accountAddress:n,amount:i,selected:s,onChecked:w,index:y.length+t})},n+t)})),y.map(((e,t)=>{let[n,i]=e;return(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(xe,{accountAddress:n,amount:i,selected:s,onChecked:w,index:t})},n+t)}))]})})})}),f&&(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{size:12,children:[(0,F.jsx)($,{style:{color:"#F9575E"},name:"warning-outline"}),(0,F.jsx)(l.Typography.Text,{style:{color:"#F9575E"},children:"Should be natural numbers"})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(oe,{})})]})}),(0,F.jsx)(K,{title:"Do you want to delete this file? ",description:"Data will not be saved.",visible:u,setVisible:p,onConfirm:t,onCancel:()=>p(!1),btnText:"delete"})]})};const ye=s.p+"static/media/icon-upload.a3c69638b092ea112d393cdc3d63d2c4.svg",ge=s.p+"static/media/example.5ac7e1383bf101857b35.csv",fe=()=>{const e=(0,n.useDispatch)(),[t,s]=(0,r.useState)(!1),[i,a]=(0,r.useState)(!1),[o,d]=(0,r.useState)({}),{recipients:{recipients:u},main:{mintSelected:h}}=(0,n.useSelector)((e=>e)),p=D(h)||0,x=(0,r.useCallback)((e=>({errorData:e.filter((e=>e.includes("")||!c.account.isAddress(e[0]))),successData:e.filter((e=>!e.includes("")&&c.account.isAddress(e[0])))})),[]),m=(0,r.useCallback)((async t=>{s(!0);const n=await(e=>new Promise(((t,s)=>Q().parse(e,{skipEmptyLines:!0,complete:e=>{let{data:s}=e;return t(s)}}))))(t),{errorData:i,successData:r}=await x(n);if(i&&e(I({errorData:i})),!p)return;const l={};let o=!1;for(const[e,s]of r)if(l[e]){o=!0;const[t,n]=l[e],i=c.utils.decimalize(n,p)+c.utils.decimalize(s,p);l[e]=[t,c.utils.undecimalize(i,p)]}else l[e]=[e,s];return o?(d(l),s(!1),a(!0),e(Z(t.name)),!0):(e(Z(t.name)),e(k({recipients:r})),s(!1),a(!1),!1)}),[x,e,p]),j=async()=>(e(A()),d({}),!0);return u.length?(0,F.jsx)(je,{remove:j}):(0,F.jsxs)(l.Row,{gutter:[8,8],justify:"end",children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Spin,{spinning:t,children:(0,F.jsx)(l.Upload.Dragger,{accept:".csv,.txt",beforeUpload:m,onRemove:j,maxCount:1,className:"upload-file",showUploadList:!0,progress:{strokeWidth:2,showInfo:!0},fileList:[],children:(0,F.jsxs)(l.Space,{direction:"vertical",size:24,align:"center",children:[(0,F.jsx)(l.Image,{src:ye,preview:!1}),(0,F.jsxs)(l.Space,{direction:"vertical",size:4,align:"center",children:[(0,F.jsx)(l.Typography.Text,{children:"Click or Drop file to upload"}),(0,F.jsxs)(l.Typography.Text,{type:"secondary",children:["The accepted file types are ",(0,F.jsx)("code",{children:".csv"}),","," ",(0,F.jsx)("code",{children:".txt"}),"."]})]})]})})})}),(0,F.jsx)(l.Col,{children:(0,F.jsx)(l.Button,{type:"text",style:{padding:0,background:"transparent",fontWeight:700},icon:(0,F.jsx)($,{name:"download-outline"}),onClick:async()=>{if(!ge)return;const e=await(async e=>fetch(e).then((function(e){var t;let s=null===(t=e.body)||void 0===t?void 0:t.getReader(),n=new TextDecoder("utf-8");return null===s||void 0===s?void 0:s.read().then((function(e){return n.decode(e.value)}))})))(ge)||"";_()(e,"example.csv")},children:"Download sample"})}),(0,F.jsx)(K,{title:"Do you want to merge wallet addresses?",description:"There are some wallet addresses that are the same.",visible:i,setVisible:a,onConfirm:()=>{const t=Object.values(o);return e(k({recipients:t})),a(!1)},onCancel:()=>{a(!1),e(Z("")),d({})},btnText:"merge"})]})},we="setting",be=(0,o.createAsyncThunk)("setting/setDecimal",(async e=>({decimal:e}))),Ce=(0,o.createAsyncThunk)("setting/setEncryption",(async e=>({encryption:e}))),ve=(0,o.createAsyncThunk)("setting/setDisabled",(async e=>({disabled:e}))),Se=(0,o.createSlice)({name:we,initialState:{decimal:!0,encryption:!1,disabled:!1},reducers:{},extraReducers:e=>{e.addCase(be.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(Ce.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase(ve.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)}))}}).reducer,ke=()=>{const e=(0,n.useDispatch)(),{main:{mintSelected:t},setting:{decimal:s,disabled:i}}=(0,n.useSelector)((e=>e)),r=D(t)||0;return(0,F.jsx)(l.Switch,{className:"decimal-switch",onChange:t=>{e(be(t))},checkedChildren:r,unCheckedChildren:r,disabled:i,checked:s})},Te=()=>{const e=(0,n.useDispatch)();return(0,F.jsxs)(l.Row,{gutter:[8,8],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{size:24,children:[(0,F.jsx)(ke,{}),(0,F.jsx)(l.Typography.Text,{children:"Decimals"})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{size:24,children:[(0,F.jsx)(l.Switch,{disabled:!0,onChange:t=>e(Ce(t))}),(0,F.jsx)(l.Typography.Text,{children:"Encrypt confidential information"})]})})]})},Ae=()=>(0,F.jsx)(l.Popover,{trigger:"click",placement:"bottom",title:null,content:(0,F.jsx)(Te,{}),children:(0,F.jsx)(l.Button,{type:"text",icon:(0,F.jsx)($,{name:"cog-outline"})})});var Re=s(4550),Ie=s.n(Re),Ne=s(51518),Be=s.n(Ne);const De=s.p+"static/media/twitter.9cbdafef0605b5c84ec56b271a60a6e8.svg",Ee=e=>{let{visible:t,redeemLink:s,onClose:n=(()=>{})}=e;const[i,a]=(0,r.useState)(!1);return(0,F.jsx)(l.Modal,{visible:t,closeIcon:(0,F.jsx)($,{name:"close-outline"}),onCancel:n,footer:null,className:"card-lightning",style:{paddingBottom:0},children:(0,F.jsxs)(l.Row,{gutter:[32,32],style:{textAlign:"center"},children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Image,{src:De,preview:!1})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{direction:"vertical",size:4,children:[(0,F.jsx)(l.Typography.Title,{level:3,children:"Share on Twitter!"}),(0,F.jsx)(l.Space,{size:4,children:(0,F.jsx)(l.Typography.Text,{type:"secondary",children:"Share this link so your recipients can get their tokens"})})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Row,{gutter:8,justify:"space-between",children:[(0,F.jsx)(l.Col,{className:"share-link",span:20,children:(0,F.jsx)(l.Typography.Text,{children:(e=>e.substring(0,40)+"...")(s)})}),(0,F.jsx)(l.Col,{span:4,children:(0,F.jsx)(l.Tooltip,{title:"Copied",visible:i,children:(0,F.jsx)(Be(),{text:s,children:(0,F.jsx)(l.Button,{size:"large",type:"ghost",onClick:async()=>{a(!0),await(0,le.sA)(1500),a(!1)},children:"copy"})})})})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Button,{size:"large",type:"primary",block:!0,onClick:()=>{let e="http://twitter.com/intent/tweet?";const t={url:s,text:"Your prize has arrived! Redeem now at Sen Hub: "};for(const s in t)e+="&"+s+"="+encodeURIComponent(t[s]||"");window.open(e,"_blank")},children:"Share now"})})]})})};var ze=s(83868);const Oe=e=>window.notify({type:"error",description:e.message});var Me=s(63805);const Pe={appId:"lightning_tunnel",url:"https://github.com/DescartesNetwork/sen-lightning-tunnel/index.js"},Fe={devnet:{node:"https://api.devnet.solana.com"},testnet:{node:"https://api.testnet.solana.com"},mainnet:{node:"https://sentre.genesysgo.net"}},Le={manifest:{development:{...Pe},staging:{...Pe},production:{...Pe}}[Me.OB],sol:Fe[Me.ef]};var qe=s(3007);const{manifest:{appId:Qe}}=Le;const We=class{constructor(e,t){if(this.db=void 0,this.key=void 0,this.set=async e=>await this.db.setItem(this.key,e),this.get=async()=>await this.db.getItem(this.key)||[],this.update=async e=>{const t=await this.get(),s=t.findIndex((t=>t.cid===e.cid));return t[s]=e,this.set(t)},this.append=async e=>{const t=[e,...await this.get()];return this.set(t)},!e)throw new Error("Invalid key");if(this.key=e,!c.account.isAddress(t))throw new Error("Invalid wallet address");const s=(0,qe.f)(t,Qe);if(!s)throw new Error("Invalid storage");this.db=s}},_e="history",Ue=(0,o.createAsyncThunk)("history/getHistory",(async e=>{if(!c.account.isAddress(e))throw new Error("Wallet is not connected");const t=new We("history",e);return await t.get()})),$e=(0,o.createAsyncThunk)("history/setStateHistory",(async(e,t)=>{let{cid:s,state:n,walletAddress:i}=e,{getState:r}=t;const{history:a}=r(),l=[...a],c=l.find((e=>e.cid===s)),o=l.findIndex((e=>e.cid===s));l[o]={...c,state:n};return new We("history",i).update({...c,state:n}),l})),Ke=(0,o.createSlice)({name:_e,initialState:[],reducers:{},extraReducers:e=>{e.addCase(Ue.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)})).addCase($e.fulfilled,((e,t)=>{let{payload:s}=t;Object.assign(e,s)}))}}).reducer,{manifest:{appId:Ye}}=Le,He=e=>{let{cid:t}=e;const[s,n]=(0,r.useState)(!1),i=`${window.location.origin}/app/${Ye}/redeem/${t}?autoInstall=true`;return(0,F.jsxs)(r.Fragment,{children:[(0,F.jsx)(l.Button,{onClick:()=>n(!0),type:"text",style:{color:"#42E6EB"},children:"share"}),(0,F.jsx)(Ee,{visible:s,onClose:()=>n(!1),redeemLink:i})]})},Ve=e=>{let{cid:t}=e;const[s,a]=(0,r.useState)(!1),{wallet:{address:c}}=(0,i.useWallet)(),{history:o}=(0,n.useSelector)((e=>e)),d=(0,n.useDispatch)();return(0,r.useMemo)((()=>{const e=o.find((e=>e.cid===t));return"DONE"===(null===e||void 0===e?void 0:e.state)}),[t,o])?(0,F.jsx)(He,{cid:t}):(0,F.jsx)(l.Button,{loading:s,onClick:async()=>{const{splt:e,wallet:s}=window.sentre;if(!s)throw new Error("Please connect wallet");a(!0);try{const n=new ze.Z,i=await n.get(t);let r=BigInt(0),l="",o="";Object.values(i).forEach((e=>{r+=BigInt(e.amount),l=e.mintAddress,o=e.distributorInfo.distributorATA}));const u=await e.deriveAssociatedAddress(c,l);console.log(r);const{txId:h}=await e.transfer(r,u,o,s);return window.notify({type:"success",description:"Transfer successfully. Click to view details.",onClick:()=>window.open((0,le.kU)(h),"_blank")}),d($e({cid:t,state:"DONE",walletAddress:c}))}catch(n){Oe(n)}finally{a(!1)}},type:"text",style:{color:"#F9575E"},children:"retry"})},Ze=[{title:"TIME",dataIndex:"time",render:e=>(0,F.jsx)(l.Typography.Text,{children:Ie()(e).format("MMM DD, YYYY HH:mm")})},{title:"TOKEN",dataIndex:"mint",render:e=>(0,F.jsxs)(l.Space,{children:[(0,F.jsx)(ie,{mintAddress:e}),(0,F.jsx)(ae,{mintAddress:e})]})},{title:"AMOUNT",dataIndex:"total",render:e=>(0,F.jsx)(l.Typography.Text,{children:(0,le.uR)(e).format("0,0.[0000]")})},{title:"ACTION",dataIndex:"cid",render:e=>(0,F.jsx)(Ve,{cid:e})}],Je=()=>{const[e,t]=(0,r.useState)(!1),{history:s}=(0,n.useSelector)((e=>e)),i=(0,r.useMemo)((()=>{let e=0;return s.forEach((t=>{"DONE"!==t.state&&e++})),e}),[s]);return(0,F.jsxs)(r.Fragment,{children:[(0,F.jsx)(l.Badge,{count:i,size:"small",children:(0,F.jsx)(l.Button,{type:"text",icon:(0,F.jsx)($,{name:"document-text-outline"}),onClick:()=>t(!0)})}),(0,F.jsx)(l.Modal,{visible:e,onCancel:()=>t(!1),closeIcon:(0,F.jsx)($,{name:"close-outline"}),footer:!1,className:"card-lightning",style:{paddingBottom:0},children:(0,F.jsxs)(l.Row,{gutter:[32,32],style:{maxHeight:500},className:"scrollbar",children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Typography.Title,{level:5,children:"Transfer history"})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{align:"baseline",children:[(0,F.jsx)($,{name:"information-circle-outline"}),(0,F.jsx)(l.Typography.Text,{children:"The history of each transaction is saved only on the device where the transaction was made."})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Table,{columns:Ze,dataSource:s,pagination:!1,rowKey:e=>e.cid})})]})})]})},Ge=e=>{let{label:t=""}=e;const{step:s}=(0,n.useSelector)((e=>e.steps)),a=(0,n.useDispatch)(),{wallet:{address:c}}=(0,i.useWallet)(),o=(0,r.useMemo)((()=>s===u.two?u.two:s===u.three?u.three:u.one),[s]),d=(0,r.useMemo)((()=>s===u.three?u.three:u.two),[s]);return(0,r.useEffect)((()=>{a(Ue(c))}),[a,c]),(0,F.jsxs)(l.Row,{children:[(0,F.jsx)(l.Col,{flex:"auto",children:(0,F.jsxs)(l.Space,{direction:"vertical",size:12,children:[(0,F.jsx)(l.Radio.Group,{value:s,className:"steps",buttonStyle:"solid",children:(0,F.jsxs)(l.Space,{children:[(0,F.jsx)(l.Radio.Button,{className:"rate-btn",value:o}),(0,F.jsx)(l.Radio.Button,{className:"rate-btn",value:d}),(0,F.jsx)(l.Radio.Button,{className:"rate-btn",value:u.three})]})}),(0,F.jsx)(l.Typography.Title,{level:5,children:t})]})}),(0,F.jsx)(l.Col,{children:(0,F.jsxs)(l.Space,{children:[(0,F.jsx)(Je,{}),(0,F.jsx)(Ae,{})]})})]})},Xe=()=>(0,F.jsx)(l.Card,{bordered:!1,className:"card-lightning",children:(0,F.jsxs)(l.Row,{gutter:[32,32],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(Ge,{label:"Fill in recipient information"})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(fe,{})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(L,{})})]})}),et=()=>{const e=(0,n.useDispatch)(),{recipients:{recipients:t},main:{mintSelected:s,isTyping:i}}=(0,n.useSelector)((e=>e)),{quantity:a}=M(),{amountError:c}=B(),o=P(s),d=(0,r.useCallback)((async()=>{await e(f()),await e(A()),e(m(u.one))}),[e]),h=a<=0||c||o<0||i;return(0,F.jsx)(l.Card,{className:"card-lightning",bordered:!1,children:(0,F.jsxs)(l.Row,{gutter:[32,32],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(Ge,{label:"Fill in recipient information"})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Row,{gutter:[24,24],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Row,{gutter:[8,8],children:[t&&t.map(((e,t)=>{let[s,n]=e;return(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(se,{amount:n,walletAddress:s,index:t})},s+t)})),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(se,{})})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(de,{})})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Row,{gutter:[16,16],children:[(0,F.jsx)(l.Col,{span:12,children:(0,F.jsx)(l.Button,{onClick:d,size:"large",type:"ghost",block:!0,children:"Back"})}),(0,F.jsx)(l.Col,{span:12,children:(0,F.jsx)(l.Button,{size:"large",type:"primary",onClick:()=>e(m(u.three)),block:!0,disabled:h,children:"Continue"})})]})})]})})},tt="Select",st=e=>{let{tokens:t,activeMintAddress:s,onSelect:n}=e;return(0,F.jsxs)(l.Select,{onChange:n,value:s||tt,className:"select-token",children:[(0,F.jsx)(l.Select.Option,{value:tt,children:(0,F.jsxs)(l.Space,{children:[(0,F.jsx)($,{style:{fontSize:25},name:"help-outline"}),(0,F.jsx)(l.Typography.Text,{style:{fontSize:16},children:"Select a token"})]})}),t.map((e=>(0,F.jsx)(l.Select.Option,{children:(0,F.jsxs)(l.Space,{children:[(0,F.jsx)(ie,{mintAddress:e}),(0,F.jsx)(ae,{mintAddress:e})]})},e)))]})};var nt=s(9722),it=s(29880);const rt=e=>{let{label:t="",value:s=""}=e;return(0,F.jsxs)(l.Row,{gutter:[8,8],children:[(0,F.jsx)(l.Col,{flex:"auto",children:(0,F.jsxs)(l.Typography.Text,{type:"secondary",children:[t," "]})}),(0,F.jsx)(l.Col,{children:s})]})};var at=s(33804),lt=s(60306);let ct=null;const ot=()=>{const[e,t]=(0,r.useState)(null),s=(0,r.useCallback)(((e,t,s)=>{const n=new at.web3.Connection(e,"confirmed"),i=new at.web3.PublicKey(t);return new at.Provider(n,{publicKey:new at.web3.PublicKey(i),signTransaction:s.signTransaction,signAllTransactions:async e=>{const t=[];for(const n of e){const e=await s.signTransaction(n);t.push(e)}return t}},{commitment:"confirmed",skipPreflight:!0})}),[]),n=(0,r.useCallback)((async()=>{const{sentre:{wallet:e,splt:n}}=window;if(!e)return t(ct=null);if(!ct){const t=await e.getAddress(),i=s(n.nodeUrl,t,e),r=lt.Qr.init({connection:i.connection,wallet:i.wallet,opts:i.opts});ct=it.qm.load({provider:r})}t(ct)}),[s]);return(0,r.useEffect)((()=>{n()}),[n]),e},{manifest:{appId:dt}}=Le,ut=()=>{const[e,t]=(0,r.useState)(!1),[s,a]=(0,r.useState)(""),{main:{mintSelected:o},setting:{decimal:d},recipients:{recipients:h}}=(0,n.useSelector)((e=>e)),{wallet:{address:p}}=(0,i.useWallet)(),x=(0,n.useDispatch)(),j=D(o)||0,{total:y,quantity:g}=M(),f=ot(),{balance:w}=O(o),b=P(o),C=(0,r.useMemo)((()=>{if(!h.length||!j)return;const e=[];return Object.values(h).forEach((t=>{let[s,n]=t;e.push({address:s,earnings:d?c.utils.decimalize(n,j).toString():n})})),it.P6.parseBalanceMap(e)}),[h,j,d]);return(0,F.jsxs)(l.Card,{bordered:!1,className:"card-lightning",children:[(0,F.jsxs)(l.Row,{gutter:[32,32],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(Ge,{label:"Confirm transfer"})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Row,{gutter:[24,24],justify:"center",children:[(0,F.jsx)(l.Col,{children:(0,F.jsxs)(l.Space,{direction:"vertical",size:12,align:"center",children:[(0,F.jsx)(l.Typography.Text,{children:"Total transfer"}),(0,F.jsx)(l.Typography.Title,{level:1,children:y}),(0,F.jsx)(l.Tag,{style:{margin:0,borderRadius:4,color:"rgb(66, 230, 235)",background:"rgba(66, 230, 235, 0.1)",border:"unset"},children:(0,F.jsx)(ae,{mintAddress:o})})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Card,{bordered:!1,className:"card-total",children:(0,F.jsxs)(l.Row,{gutter:[8,8],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(rt,{label:"Time",value:Ie()(new Date).format("DD MMM, YYYY HH:MM")})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(rt,{label:"Quantity",value:g})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(rt,{label:"Your balance",value:(0,F.jsxs)(l.Typography.Text,{children:[(0,le.uR)(w).format("0,0.00[0000]")," ",(0,F.jsx)(ae,{mintAddress:o})]})})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(rt,{label:"Remaining",value:(0,F.jsxs)(l.Typography.Text,{children:[(0,le.uR)(b).format("0,0.00[00]")," ",(0,F.jsx)(ae,{mintAddress:o})]})})})]})})})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Row,{gutter:[8,8],children:[(0,F.jsx)(l.Col,{span:12,children:(0,F.jsx)(l.Button,{size:"large",onClick:()=>x(m(u.two)),block:!0,type:"ghost",children:"BACK"})}),(0,F.jsx)(l.Col,{span:12,children:(0,F.jsx)(l.Button,{size:"large",onClick:async()=>{if(f&&c.account.isAddress(o)&&C){t(!0);try{const{splt:s,wallet:n}=window.sentre;if(!n)throw new Error("Please connect wallet");const{merkleRoot:i}=C,r=c.utils.decimalize(y,j).toString(),l=c.account.fromAddress(o),{tx:d,distributor:u,distributorATA:h}=await f.createDistributor({tokenMint:l,root:i,maxNumNodes:new nt.AW(g),maxTotalClaim:new nt.AW(r)}),m=await d.send();try{await m.wait()}catch(e){return console.warn(e.message)}const w={distributor:u.toBase58(),distributorATA:h.toBase58()},b=((e,t,s)=>{if(!e)return{};const{claims:n}=e,i={};return Object.keys(n).forEach((e=>{const{amount:r,index:a,proof:l}=n[e],c={index:a,proof:l,amount:r.toString(),claimant:e,distributorInfo:t,mintAddress:s};i[e]=c})),i})(C,w,o),v=new ze.Z,S=await v.set(b),k={cid:S,total:y,time:(new Date).toString(),mint:o,state:"IN_PROGRESS"},T=new We("history",p);await T.append(k),await x(Ue(p));const A=await s.deriveAssociatedAddress(p,o),{txId:R}=await s.transfer(BigInt(r),A,w.distributorATA,n);return window.notify({type:"success",description:"Transfer successfully. Click to view details.",onClick:()=>window.open((0,le.kU)(R),"_blank")}),await x($e({cid:S,state:"DONE",walletAddress:p})),a(`${window.location.origin}/app/${dt}/redeem/${S}?autoInstall=true`)}catch(e){return window.notify({type:"error",description:e.message})}finally{return t(!1)}}},type:"primary",loading:e,disabled:b<0,block:!0,children:"TRANSFER"})})]})})]}),(0,F.jsx)(Ee,{visible:Boolean(s),onClose:()=>a(""),redeemLink:s})]})},ht=e=>{let{label:t,description:s,active:n}=e;return(0,F.jsxs)(r.Fragment,{children:[n?(0,F.jsx)($,{name:"checkbox-sharp",style:{position:"absolute",top:0,right:0,color:"#42E6EB",fontSize:20}}):null,(0,F.jsxs)(l.Row,{gutter:[12,12],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Typography.Title,{level:5,children:t})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Typography.Text,{type:"secondary",children:s})})]})]})},pt=()=>{const[e,t]=(0,r.useState)(d.manual),[s,a]=(0,r.useState)("Select"),c=(0,n.useDispatch)(),{accounts:o}=(0,i.useAccount)(),h=(e=>{const{tokenProvider:t}=(0,i.useMint)(),[s,n]=(0,r.useState)([]),a=(0,r.useCallback)((async()=>{const s=[];for(const n of e)await t.findByAddress(n)&&s.push(n);return n(s)}),[t,e]);return(0,r.useEffect)((()=>{a()}),[a]),s})((0,r.useMemo)((()=>Object.values(o).map((e=>e.mint))),[o])),p=(0,r.useMemo)((()=>"Select"===s||!e),[s,e]);return(0,F.jsx)(l.Card,{className:"card-lightning",bordered:!1,children:(0,F.jsxs)(l.Row,{gutter:[32,32],align:"middle",children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(Ge,{label:"Select token type and input method"})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Row,{gutter:[24,24],children:[(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(st,{activeMintAddress:s,tokens:h,onSelect:e=>{a(e),c(w(e))}})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{size:12,direction:"vertical",style:{width:"100%"},children:[(0,F.jsx)(l.Typography.Text,{children:"Choose transfer info input method"}),(0,F.jsx)(l.Radio.Group,{onChange:e=>t(e.target.value),style:{width:"100%"},className:"select-card",children:(0,F.jsxs)(l.Row,{gutter:[12,12],children:[(0,F.jsx)(l.Col,{xs:24,sm:12,md:12,lg:12,children:(0,F.jsx)(l.Radio.Button,{value:d.manual,children:(0,F.jsx)(ht,{label:"Manual",description:"With a small number of recipients.",active:e===d.manual})})}),(0,F.jsx)(l.Col,{xs:24,sm:12,md:12,lg:12,children:(0,F.jsx)(l.Radio.Button,{value:d.auto,children:(0,F.jsx)(ht,{label:"Automatic",description:"Support bulk import with a CSV file.",active:e===d.auto})})})]})})]})})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Button,{size:"large",onClick:()=>{c(f(e)),c(m(u.two))},block:!0,type:"primary",disabled:p,children:"Continue"})})]})})},xt=()=>{const{main:{methodSelected:e},steps:{step:t}}=(0,n.useSelector)((e=>e));return e?t===u.two?e===d.auto?(0,F.jsx)(Xe,{}):(0,F.jsx)(et,{}):(0,F.jsx)(ut,{}):(0,F.jsx)(pt,{})};var mt=s(71256);const{manifest:{appId:jt}}=Le,yt=()=>{const e=(0,a.useLocation)(),t=(0,a.useHistory)(),s=(0,r.useMemo)((()=>new URLSearchParams(e.search)),[e.search]),n=(0,r.useCallback)((e=>s.get(e)),[s]),i=(0,r.useCallback)((e=>{const t=new URLSearchParams;for(const s in e)t.set(s,e[s]);return t.toString()}),[]),l=(0,r.useMemo)((()=>`/app/${jt}`),[]);return{getQuery:n,generateQuery:i,pushHistory:(0,r.useCallback)((e=>t.push(`${l}${e}`)),[l,t]),appRoute:l}};const gt=s.p+"static/media/redeem.7e0fa96ccc80d536f7730bb34ab5753b.svg";var ft=s(97429).Buffer;const wt=()=>{const[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(!1),[o,d]=(0,r.useState)(),{wallet:{address:u}}=(0,i.useWallet)(),h=ot(),{pushHistory:p}=yt(),x=D((null===o||void 0===o?void 0:o.mintAddress)||"")||0,m=(0,a.useParams)(),j=(0,r.useCallback)((async()=>{if(!m.cid)return;n(!0);const e=new ze.Z;try{const t=await e.get(m.cid);for(const e of Object.keys(t))if(e===u)return d(t[e]);return window.notify({type:"warning",description:"You are not in the list."})}catch(t){return window.notify({type:"error",description:"Redeem code not found"})}finally{return n(!1)}}),[m.cid,u]),y=(0,r.useCallback)((async e=>{if(!h)return;const t=c.account.fromAddress(e);return await it.yV.load(h,t)}),[h]),g=(0,r.useMemo)((()=>{const e=[];if(null===o||void 0===o||!o.proof)return e;const{proof:t}=o;return t.forEach((t=>{let{data:s}=t;e.push(ft.from(s))})),e}),[o]),f=(0,r.useCallback)((async()=>{if(!o||!o.distributorInfo)return;t(!0);const{index:e,amount:s,distributorInfo:{distributor:n}}=o,i=await y(n);if(!c.account.isAddress(n)||!i)return window.notify({type:"error",description:"Distributor does not exist"});try{const{isClaimed:s}=await i.getClaimStatus(new nt.AW(e));if(s)return t(!1),window.notify({type:"error",description:"Tokens has been redeemed"})}catch(r){}try{const n=await i.claim({index:new nt.AW(e),amount:new nt.AW(s),proof:g,claimant:new mt.PublicKey(u)}),{signature:r,response:{meta:a}}=await n.confirm();return null!==a&&void 0!==a&&a.err?window.notify({type:"error",description:"Something went wrong"}):((e,t)=>window.notify({type:"success",description:`${e} successfully. Click to view details.`,onClick:()=>window.open((0,le.kU)(t),"_blank")}))("Claim",r)}catch(r){Oe(r)}finally{t(!1)}}),[g,o,y,u]);return(0,r.useEffect)((()=>{j()}),[j]),(0,F.jsx)(l.Row,{gutter:[24,24],justify:"center",className:"lightning-container",children:(0,F.jsx)(l.Col,{xs:24,md:16,lg:12,xl:10,children:(0,F.jsx)(l.Card,{style:{minHeight:430},loading:s,className:"card-lightning",bordered:!1,children:(0,F.jsxs)(l.Row,{gutter:[32,32],style:{textAlign:"center"},children:[(0,F.jsx)(l.Col,{span:24,style:{textAlign:"left"},children:(0,F.jsx)(l.Button,{type:"text",icon:(0,F.jsx)($,{name:"arrow-back-outline"}),onClick:()=>p(""),style:{margin:-12},children:"Back"})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Image,{src:gt,preview:!1})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsxs)(l.Space,{direction:"vertical",size:4,children:[(0,F.jsx)(l.Typography.Title,{level:3,children:"Redemption!"}),(0,F.jsxs)(l.Space,{size:4,children:[(0,F.jsx)(l.Typography.Text,{type:"secondary",children:"Let's take"})," ",(0,F.jsxs)(l.Typography.Title,{level:5,style:{color:"#42E6EB"},children:[c.utils.undecimalize(BigInt((null===o||void 0===o?void 0:o.amount)||0),x)," ",(0,F.jsx)(ae,{mintAddress:(null===o||void 0===o?void 0:o.mintAddress)||""})]})]})]})}),(0,F.jsx)(l.Col,{span:24,children:(0,F.jsx)(l.Button,{type:"primary",onClick:f,loading:e,children:"Redeem"})})]})})})})},bt=s.p+"static/media/background-LT.4c9e016f719ffe61dc63.png",Ct=()=>(0,F.jsx)(l.Row,{gutter:[24,24],justify:"center",className:"lightning-container",children:(0,F.jsx)(l.Col,{xs:24,md:16,lg:12,xl:10,children:(0,F.jsx)(xt,{})})}),vt=()=>{const{appRoute:e}=yt(),{setBackground:t}=(0,i.useUI)();return(0,r.useEffect)((()=>{t({light:bt,dark:bt})}),[t]),(0,F.jsxs)(a.Switch,{children:[(0,F.jsx)(a.Route,{exact:!0,path:e,component:Ct}),(0,F.jsx)(a.Route,{path:`${e}/redeem/:cid`,component:wt})]})},St=e=>{let{children:t}=e;return(0,F.jsxs)("div",{className:"background-container",children:[t,Array.apply(null,Array(20)).map(((e,t)=>(0,F.jsx)("div",{className:"circle-container",children:(0,F.jsx)("div",{className:"circle"})},t)))]})};var kt=s(85912);const Tt=(0,o.configureStore)({middleware:e=>e(kt.h),devTools:(0,kt.$)("lightning_tunnel"),reducer:{main:v,steps:j,setting:Se,recipients:N,file:X,history:Ke}}),{manifest:{appId:At}}=Le,Rt=()=>(0,F.jsx)(i.UIProvider,{appId:At,antd:{prefixCls:At},children:(0,F.jsx)(i.MintProvider,{children:(0,F.jsx)(i.PoolProvider,{children:(0,F.jsx)(i.AccountProvider,{children:(0,F.jsx)(i.WalletProvider,{children:(0,F.jsx)(n.Provider,{store:Tt,children:(0,F.jsx)(St,{children:(0,F.jsx)(vt,{})})})})})})})})},57452:()=>{"use strict";const e={ttl:3e4},t={limit:{calls:10,time:1e3},cache:e};class s{constructor(e){this.key="",this.resolveQueue=[],this.rejectQueue=[],this.key=e}add(e,t){this.resolveQueue.push(e),this.rejectQueue.push(t)}resolves(e){for(;this.resolveQueue.length>0;){this.resolveQueue.shift()(e)}}rejects(e){for(;this.rejectQueue.length>0;){this.rejectQueue.shift()(e)}}}class n{static set(t,s){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.mapCache.set(t,s),setTimeout((()=>{this.mapCache.delete(t)}),n.ttl)}static get(e){return this.mapCache.get(e)}}n.mapCache=new Map;class i{static getSingleFlight(e){const t=JSON.stringify(e);if(this.mapInstance.has(t)){const e=this.mapInstance.get(t);if(e)return e}let s=new r(e);return this.mapInstance.set(t,s),s}static async load(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"===typeof e&&(e=JSON.stringify(e));let r=i.getSingleFlight(n);i.mapInstance.set(e,r);const a=new s(e);return r.load(a,t)}}i.mapInstance=new Map;class r{constructor(e){this.config=void 0,this.intervalRequest=void 0,this.timeLogs=[],this.mapRequestCalling=new Map,this.requestQueue=[],this.config=Object.assign(t,e)}async load(e,t){const s=n.get(e.key);if(s)return Promise.resolve(s);let i=!1,r=this.mapRequestCalling.get(e.key);return r||(r=e,i=!0,this.mapRequestCalling.set(r.key,r)),new Promise(((e,s)=>{if(!r)return s("Not found request!");r.add(e,s),i&&this.fetch(r,t)}))}fetch(e,t){if(!this.validateLimit())return this.addRequestQueue(e,t);this.createTimeLogs(),t().then((t=>{n.set(e.key,t,this.config.cache),e.resolves(t)})).catch((t=>{e.rejects(t)})).finally((()=>{this.mapRequestCalling.delete(e.key),this.fetchRequestQueue(t)}))}fetchRequestQueue(e){if(!this.validateLimit())return;const t=this.requestQueue.shift();t&&this.load(t,e),0===this.requestQueue.length&&this.intervalRequest&&clearInterval(this.intervalRequest)}addRequestQueue(e,t){var s;this.requestQueue.push(e),this.intervalRequest=setInterval((()=>{this.fetchRequestQueue(t)}),null===(s=this.config.limit)||void 0===s?void 0:s.time)}validateLimit(){return!0}createTimeLogs(){var e;if(!this.config.limit)return;const t=(new Date).getTime();this.timeLogs.push(t),this.timeLogs.length>(null===(e=this.config.limit)||void 0===e?void 0:e.calls)&&this.timeLogs.shift()}}},85912:(e,t,s)=>{"use strict";s.d(t,{$:()=>l,h:()=>c});var n=s(71256),i=s(48744),r=s.n(i),a=s(97429).Buffer;const l=e=>!1;BigInt.prototype.toJSON=function(){return this.toString()};const c={serializableCheck:{isSerializable:e=>"undefined"===typeof e||null===e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||Array.isArray(e)||(e=>{if(null===e)return!1;const t=Object.getPrototypeOf(e);return null!==t&&null===Object.getPrototypeOf(t)})(e)||"bigint"===typeof e||e instanceof n.PublicKey||e instanceof r()||e instanceof a}}},3007:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c,f:()=>o});var n=s(15454),i=s.n(n),r=s(95418),a=s(83868);class l{constructor(e){if(this.dbName=void 0,this.driver=void 0,this.ipfs=void 0,this.createInstance=e=>i().createInstance({driver:this.driver,name:this.dbName,storeName:e}),this.dropInstance=async e=>{const t=this.createInstance(e);return await t.clear(),await i().dropInstance({name:this.dbName,storeName:e})},this.all=async()=>{let e={};const t=(await this.createInstance("sentre").getItem("appIds")||[]).flat().concat(["sentre"]);for(const s of t){e[s]={};const t=this.createInstance(s);await t.iterate(((t,n)=>{e[s][n]=t}))}return e},this.fetch=async e=>await this.ipfs.get(e),this.backup=async()=>{const e=await this.all();return await this.ipfs.set(e)},this.restore=async e=>{const t=await this.fetch(e);for(const s in t){const e=await this.createInstance(s);for(const n in t[s]){const i=t[s][n];await e.setItem(n,i)}}return t},!r.account.isAddress(e))throw new Error("Invalid address");this.dbName=e,this.driver=[i().WEBSQL,i().LOCALSTORAGE],this.ipfs=new a.Z}}const c=l,o=(e,t)=>r.account.isAddress(e)?new l(e).createInstance(t):void 0},83868:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(52322),i=s(34559),r=s(97429).Buffer;class a{constructor(){this._ipfs=async()=>{try{return window.ipfs||(window.ipfs=await(0,n.Ue)()),window.ipfs}catch(e){return await(0,i.sA)(500),await this._ipfs()}},this.get=async e=>{if(!a.isCID(e))throw new Error("Invalid CID");const t=await this._ipfs(),s=await t.cat(e);let n="";for await(const i of s)n+=r.from(i).toString();return JSON.parse(n)},this.set=async e=>{if(!e)throw new Error("Empty data");const t=JSON.stringify(e),s=await this._ipfs(),{cid:n}=await s.add(t);return n.toString()}}}a.isCID=e=>{try{return!!e&&n.bf.multihash(e)}catch(t){return!1}};const l=a},63805:(e,t,s)=>{"use strict";s.d(t,{Bv:()=>a,OB:()=>i,ef:()=>r,f4:()=>u});var n=s(53933);const i="production",r=(()=>{switch(n.Z.get("network")){case"devnet":return"devnet";case"testnet":return"testnet";default:return"mainnet"}})(),a=(()=>{switch(r){case"devnet":return 103;case"testnet":return 102;default:return 101}})(),l=["https://api.devnet.solana.com","https://psytrbhymqlkfrhudd.dev.genesysgo.net:8899/"],c=["https://api.testnet.solana.com"],o=["https://ssc-dao.genesysgo.net/","https://solana-api.projectserum.com"],d=e=>{const t=e[Math.floor(Math.random()*e.length)];return console.log("Debug OS RPC:",t),t},u=(()=>{switch(r){case"devnet":return d(l);case"testnet":return d(c);default:return d(o)}})()},53933:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});const n="sentre",i=window.localStorage,r=e=>{try{return e?JSON.parse(e):null}catch(t){return null}},a={set:(e,t)=>{let s=r(i.getItem(n));s&&"object"===typeof s||(s={}),s[e]=t,i.setItem(n,JSON.stringify(s))},get:e=>{let t=r(i.getItem(n));return t&&"object"===typeof t?t[e]:null},clear:e=>{a.set(e,null)}},l=a},34559:(e,t,s)=>{"use strict";s.d(t,{Xn:()=>c,kU:()=>o,sA:()=>l,uR:()=>d});var n=s(95418),i=s(16200),r=s.n(i),a=s(63805);s(57452);const l=e=>new Promise((t=>setTimeout(t,e))),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";return e.substring(0,t)+s+e.substring(e.length-t,e.length)},o=e=>n.account.isAddress(e)?`https://explorer.solana.com/address/${e}?cluster=${a.ef}`:`https://explorer.solana.com/tx/${e}?cluster=${a.ef}`,d=e=>e?r()(e):r()("0")},43094:()=>{},69159:()=>{},35883:()=>{},46601:()=>{},89214:()=>{},5696:()=>{},85568:()=>{},64009:()=>{},42611:()=>{},88795:()=>{},89408:()=>{},47956:()=>{},21724:()=>{},62678:()=>{},25819:()=>{},52361:()=>{},94616:()=>{},55024:()=>{}}]);
//# sourceMappingURL=871.fd4e13c5.chunk.js.map